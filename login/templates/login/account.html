{% extends 'Nav.html'%}
{% load static %}
{% block start %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="{% static 'login/account.css' %}">

<div class="container mt-5">
    <div class="row g-4">
        <div class="col-lg-8">
            <div class="glass-card p-4 h-100">
                <h1 class="display-6 border-bottom pb-2">Account Details</h1>
                <div class="mt-4">
                    <p class="h5"><strong>Account No:</strong> {{user}}</p>
                    <p class="h5"><strong>Holder:</strong> {{user.first_name}}</p>
                    <p class="h5"><strong>Mobile:</strong> {{detail.Mobile_no}}</p>
                    <p class="h5"><strong>Status:</strong>
                        <span class="badge {% if detail.status %}bg-success{% else %}bg-danger{% endif %}">
                            {% if detail.status %}Active{% else %}Closed{% endif %}
                        </span>
                    </p>
                </div>
                <div class="mt-4 pt-3 border-top">
                    <a href="{% url 'LoginApp:transfer' %}" class="btn btn-primary me-2">Transfer Money</a>
                    <a href="{% url 'LoginApp:statement' %}?t=True" class="btn btn-outline-light">Full Statement</a>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="glass-card p-4 h-100">
                <h3 class="h5 mb-3">Recent Activity</h3>
                <div id="left" class="transaction-list">
                </div>
            </div>
        </div>

    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        fetch('statement/')
            .then(response => response.json())
            .then(statements => {
                console.log("data", statements)
                let count = 1
                statements.forEach(Element => {
                    const colorClass = Element.cash < 0 ? 'text-danger' : 'text-success';
                    const symbol = Element.cash > 0 ? '+' : '';
                    const Div = document.createElement('div')
                    Div.innerHTML = `
                        <div class="d-flex justify-content-between align-items-center rounded p-2 mb-1 statement">
                            <div>
                                <div class="small opacity-75">${Element.detail}</div>
                                <div class="fw-bold">Bal: â‚¹${Element.balance}</div>
                            </div>
                            <div class="h5 mb-0 ${colorClass}">
                                ${symbol}${Element.cash}
                            </div>
                        </div>
                    `;

                    document.querySelector("#left").appendChild(Div)
                    count++
                });
            })
    })

</script>

{% endblock %}